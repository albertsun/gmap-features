if(!window.typeOf)window.typeOf=function(a){var b=typeof a;b==="object"&&(a?a instanceof Array&&(b="array"):b="null");return b};if(!window.console)window.console={log:function(){}};
var gmap=gmap||{},_=_||function(){var a={},b=Array.prototype.slice,c=Array.prototype.forEach,e=a.each=a.forEach=function(a,b,e){if(a!=null)if(c&&a.forEach===c)a.forEach(b,e);else if(a.length===+a.length)for(var g=0,i=a.length;g<i;g++){if(g in a&&b.call(e,a[g],g,a)===breaker)break}else for(g in a)if(hasOwnProperty.call(a,g)&&b.call(e,a[g],g,a)===breaker)break};a.extend=function(a){e(b.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])});return a};return a}();
google.maps.LatLng.prototype.toGeoJSON=function(){return[this.lng(),this.lat()]};google.maps.MVCArray.prototype.toGeoJSON=function(){for(var a=this.getArray(),b=[],c=0,e=a.length;c<e;c++)b.push(a[c].toGeoJSON());return b};
gmap.Feature=function(a){function b(){f.setHighlighted(!0)}function c(){f.setHighlighted(!1)}function e(){f.getSelected()?f.setSelected(!1):f.setSelected(!0)}var f=this;this.id=a.id;this.polygons=[];if(a.fields)this.fields=a.fields;this.controller=a.controller;this._highlighted=this._selected=!1;if(a.highlightCallback)this.highlightCallback=a.highlightCallback;if(a.selectCallback)this.selectCallback=a.selectCallback;this.unselected_poly_options=a.color?_.extend({},this._unselected_poly_options,{fillColor:a.color}):
_.extend({},this._unselected_poly_options);for(var d=0,h=a.multipolygon.length;d<h;d++)this.polygons.push(new google.maps.Polygon(_.extend({},this.unselected_poly_options,{paths:a.multipolygon[d],map:a.map}))),google.maps.event.addListener(this.polygons[d],"mousemove",b),google.maps.event.addListener(this.polygons[d],"mouseout",c),google.maps.event.addListener(this.polygons[d],"click",e)};
gmap.Feature.prototype={_unselected_poly_options:{clickable:!0,fillColor:"#AAAAAA",strokeColor:"#000000",strokeWeight:1,strokeOpacity:0.25},_selected_poly_options:{strokeOpacity:1,strokeWeight:1,strokeColor:"#0000FF"},_highlighted_poly_options:{strokeOpacity:1,strokeWeight:1,strokeColor:"#00FF00"},remove:function(){for(var a=0,b=this.polygons.length;a<b;a++)google.maps.event.clearListeners(this.polygons[a],"mousemove"),google.maps.event.clearListeners(this.polygons[a],"mouseout"),this.polygons[a].setMap(null);
this.polygons=this.controller=null},toGeoJSON:function(){for(var a=[],b=0,c=this.polygons.length;b<c;b++)a.push(this.polygons[b].getPaths().toGeoJSON());return a},getSelected:function(){return this._selected},setSelected:function(a){var b;if(a===!0){this.controller.selected!==null&&this.controller.selected.setSelected(!1);for(a=0,b=this.polygons.length;a<b;a++)this.polygons[a].setOptions(this._selected_poly_options);this._selected=!0;this.controller.selected=this;this.selectCallback&&this.selectCallback()}else if(a===
!1){for(a=0,b=this.polygons.length;a<b;a++)this.polygons[a].setOptions(this._unselected_poly_options);this._selected=!1}},getHighlighted:function(){return this._highlighted},setHighlighted:function(a){var b;if(a===!0&&this._highlighted===!1){this._highlighted=!0;for(a=0,b=this.polygons.length;a<b;a++)this.polygons[a].setOptions(this._highlighted_poly_options);this.highlightCallback&&this.highlightCallback()}else if(a===!1&&this._highlighted===!0){this._highlighted=!1;var c;c=this.getSelected()?_.extend({},
this.unselected_poly_options,this._selected_poly_options):_.extend({},c,this.unselected_poly_options);for(a=0,b=this.polygons.length;a<b;a++)this.polygons[a].setOptions(c)}}};if(!window.typeOf)window.typeOf=function(a){var b=typeof a;b==="object"&&(a?a instanceof Array&&(b="array"):b="null");return b};if(!window.console)window.console={log:function(){}};gmap=gmap||{};gmap.geom=gmap.geom||{};
gmap.geom.ParseGeoJSONMultiPolygon=function(a){var b,c,e,f,d,h,g=[],i,j;for(b=0,c=a.length;b<c;b++){i=[];for(e=0,f=a[b].length;e<f;e++){j=[];for(d=0,h=a[b][e].length;d<h;d++)j.push(new google.maps.LatLng(a[b][e][d][1],a[b][e][d][0]));i.push(j)}g.push(i)}return g};gmap.geom.ParseGeoJSONPolygon=function(a){var b,c,e,f,d=[],h;for(b=0,c=a.length;b<c;b++){h=[];for(e=0,f=a[b].length;e<f;e++)h.push(new google.maps.LatLng(a[b][e][1],a[b][e][0]));d.push(h)}return d};gmap=gmap||{};
gmap.load_polygons=function(a){var b={},c=a.data,e={selected:null};a.unselected_opts&&_.extend(gmap.Feature.prototype._unselected_poly_options,a.unselected_opts);a.highlighted_opts&&_.extend(gmap.Feature.prototype._highlighted_poly_options,a.highlighted_opts);a.selected_opts&&_.extend(gmap.Feature.prototype._selected_poly_options,a.selected_opts);for(var f,d=0,h=c.length;d<h;d++){f=c[d].geom.type=="Polygon"?[gmap.geom.ParseGeoJSONPolygon(c[d].geom.coordinates)]:gmap.geom.ParseGeoJSONMultiPolygon(c[d].geom.coordinates);
f={id:c[d].id,multipolygon:f,fields:c[d].fields,controller:e,map:a.map};if(a.getColor)f.color=a.getColor(c[d].fields);if(a.highlightCallback)f.highlightCallback=a.highlightCallback;if(a.selectCallback)f.selectCallback=a.selectCallback;b[c[d].id]=new gmap.Feature(f)}return b};
