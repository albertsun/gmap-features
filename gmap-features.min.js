if(!window.typeOf)window.typeOf=function(a){var b=typeof a;b==="object"&&(a?a instanceof Array&&(b="array"):b="null");return b};if(!window.console)window.console={log:function(){}};var gmap=gmap||{};
(function(){gmap._=window._||function(){var a={},b=Array.prototype.slice,f=Array.prototype.forEach,c=a.each=a.forEach=function(a,b,c){if(a!=null)if(f&&a.forEach===f)a.forEach(b,c);else if(a.length===+a.length)for(var h=0,i=a.length;h<i;h++){if(h in a&&b.call(c,a[h],h,a)===breaker)break}else for(h in a)if(hasOwnProperty.call(a,h)&&b.call(c,a[h],h,a)===breaker)break};a.extend=function(a){c(b.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])});return a};return a}();google.maps.LatLng.prototype.toGeoJSON=
function(){return[this.lng(),this.lat()]};google.maps.MVCArray.prototype.toGeoJSON=function(){for(var a=this.getArray(),b=[],f=0,c=a.length;f<c;f++)b.push(a[f].toGeoJSON());return b};gmap.Feature=function(a){function b(){g.setHighlighted(!0)}function f(){g.setHighlighted(!1)}function c(){g.getSelected()?g.setSelected(!1):g.setSelected(!0)}var g=this;this.id=a.id;this.polygons=[];if(a.fields)this.fields=a.fields;this.controller=a.controller;this._highlighted=this._selected=!1;if(a.highlightCallback)this.highlightCallback=
a.highlightCallback;if(a.selectCallback)this.selectCallback=a.selectCallback;this.unselected_poly_options=a.color?gmap._.extend({},this._unselected_poly_options,{fillColor:a.color}):gmap._.extend({},this._unselected_poly_options);for(var d=0,e=a.multipolygon.length;d<e;d++)this.polygons.push(new google.maps.Polygon(gmap._.extend({},this.unselected_poly_options,{paths:a.multipolygon[d],map:a.map}))),google.maps.event.addListener(this.polygons[d],"mousemove",b),google.maps.event.addListener(this.polygons[d],
"mouseout",f),google.maps.event.addListener(this.polygons[d],"click",c)};gmap.Feature.prototype={_unselected_poly_options:{clickable:!0,fillColor:"#AAAAAA",strokeColor:"#000000",strokeWeight:1,strokeOpacity:0.25},_selected_poly_options:{strokeOpacity:1,strokeWeight:1,strokeColor:"#0000FF"},_highlighted_poly_options:{strokeOpacity:1,strokeWeight:1,strokeColor:"#00FF00"},remove:function(){for(var a=0,b=this.polygons.length;a<b;a++)google.maps.event.clearListeners(this.polygons[a],"mousemove"),google.maps.event.clearListeners(this.polygons[a],
"mouseout"),this.polygons[a].setMap(null);this.polygons=this.controller=null},toGeoJSON:function(){for(var a=[],b=0,f=this.polygons.length;b<f;b++)a.push(this.polygons[b].getPaths().toGeoJSON());return a},getSelected:function(){return this._selected},setSelected:function(a){var b;if(a===!0){this.controller.selected!==null&&this.controller.selected.setSelected(!1);for(a=0,b=this.polygons.length;a<b;a++)this.polygons[a].setOptions(this._selected_poly_options);this._selected=!0;this.controller.selected=
this;this.selectCallback&&this.selectCallback()}else if(a===!1){for(a=0,b=this.polygons.length;a<b;a++)this.polygons[a].setOptions(this.unselected_poly_options);this._selected=!1}},getHighlighted:function(){return this._highlighted},setHighlighted:function(a){var b;if(a===!0&&this._highlighted===!1){this._highlighted=!0;for(a=0,b=this.polygons.length;a<b;a++)this.polygons[a].setOptions(this._highlighted_poly_options);this.highlightCallback&&this.highlightCallback()}else if(a===!1&&this._highlighted===
!0){this._highlighted=!1;var f;f=this.getSelected()?gmap._.extend({},this.unselected_poly_options,this._selected_poly_options):gmap._.extend({},f,this.unselected_poly_options);for(a=0,b=this.polygons.length;a<b;a++)this.polygons[a].setOptions(f)}}}})();if(!window.typeOf)window.typeOf=function(a){var b=typeof a;b==="object"&&(a?a instanceof Array&&(b="array"):b="null");return b};if(!window.console)window.console={log:function(){}};gmap=gmap||{};gmap.geom=gmap.geom||{};
gmap.geom.ParseGeoJSONMultiPolygon=function(a){var b,f,c,g,d,e,h=[],i,j;for(b=0,f=a.length;b<f;b++){i=[];for(c=0,g=a[b].length;c<g;c++){j=[];for(d=0,e=a[b][c].length;d<e;d++)j.push(new google.maps.LatLng(a[b][c][d][1],a[b][c][d][0]));i.push(j)}h.push(i)}return h};gmap.geom.ParseGeoJSONPolygon=function(a){var b,f,c,g,d=[],e;for(b=0,f=a.length;b<f;b++){e=[];for(c=0,g=a[b].length;c<g;c++)e.push(new google.maps.LatLng(a[b][c][1],a[b][c][0]));d.push(e)}return d};
gmap.geom.ParseKMLMultiPolygon=function(a){return $.map($(a).find("Polygon"),function(a){return[$.map($(a).find("coordinates"),function(a){a=$(a).text().split(/\s+/);return[$.map(a,function(a){if(a!=="")return new google.maps.LatLng(parseFloat($.trim(a).split(",")[1]),parseFloat($.trim(a).split(",")[0]))})]})]})};gmap=gmap||{};
(function(){function a(a){a=$(a);return $.map(a.find("Placemark"),function(a){var b={};$placemark=$(a);b.geometry=$placemark.find("MultiGeometry")[0];b.id=$placemark.find("name").text();b.properties={};for(var a=$placemark.find("ExtendedData Data"),g,d,e=0,h=a.length;e<h;e++)g=$(a[e]),d=g.find("value").text(),isNaN(parseFloat(d))||(d=Number(d)),b.properties[g.attr("name")]=d;return b})}gmap.load_polygons=function(b){var f={},c=b.data,g={selected:null},c=b.data_type=="kml"?a(c):c.features;b.unselected_opts&&
gmap._.extend(gmap.Feature.prototype._unselected_poly_options,b.unselected_opts);b.highlighted_opts&&gmap._.extend(gmap.Feature.prototype._highlighted_poly_options,b.highlighted_opts);b.selected_opts&&gmap._.extend(gmap.Feature.prototype._selected_poly_options,b.selected_opts);for(var d,e=0,h=c.length;e<h;e++){d=c[e].geometry.coordinates?c[e].geometry.type=="Polygon"?[gmap.geom.ParseGeoJSONPolygon(c[e].geometry.coordinates)]:gmap.geom.ParseGeoJSONMultiPolygon(c[e].geometry.coordinates):gmap.geom.ParseKMLMultiPolygon(c[e].geometry);
d={id:c[e].id,multipolygon:d,fields:c[e].properties,controller:g,map:b.map};if(b.getColor)d.color=b.getColor(c[e].properties);if(b.highlightCallback)d.highlightCallback=b.highlightCallback;if(b.selectCallback)d.selectCallback=b.selectCallback;f[c[e].id]=new gmap.Feature(d)}return f}})();
